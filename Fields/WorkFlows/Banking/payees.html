<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Payees Management</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans min-h-screen">

<!-- Navbar -->
<nav class="bg-purple-600 text-white p-4 flex justify-between items-center shadow-lg">
  <h1 class="text-xl font-bold">Automation Playground</h1>
  <div class="space-x-6">
    <a href="dashboard.html" class="hover:text-gray-200">Dashboard</a>
    <a href="transfer.html" class="hover:text-gray-200">Fund Transfer</a>
    <a href="history.html" class="hover:text-gray-200">Transaction History</a>
  </div>
</nav>

<div class="max-w-6xl mx-auto mt-8 bg-white p-6 rounded-2xl shadow-lg">

  <h2 class="text-2xl font-semibold text-gray-700 mb-4 text-center">Manage Payees</h2>

  <!-- Existing Payees Table -->
  <div class="overflow-x-auto mb-6">
    <h3 class="text-lg font-semibold mb-2">Existing Payees</h3>
    <table class="w-full table-auto border border-gray-200">
      <thead class="bg-gray-100">
        <tr>
          <th class="px-4 py-2 border">Name</th>
          <th class="px-4 py-2 border">Bank</th>
          <th class="px-4 py-2 border">Branch</th>
          <th class="px-4 py-2 border">Account Number</th>
          <th class="px-4 py-2 border">Action</th>
        </tr>
      </thead>
      <tbody id="payeesTableBody">
        <!-- Dynamic payees -->
      </tbody>
    </table>
  </div>

  <!-- Add New Payee -->
  <div class="mb-6">
    <h3 class="text-lg font-semibold mb-2">Add New Payee</h3>
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-2">
      <input id="addName" type="text" placeholder="Name" class="p-2 border rounded">
      <input id="addBank" type="text" placeholder="Bank" class="p-2 border rounded">
      <input id="addBranch" type="text" placeholder="Branch" class="p-2 border rounded">
      <input id="addAccount" type="text" placeholder="Account Number" class="p-2 border rounded">
    </div>
    <button id="addPayeeBtn" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Add Payee</button>
  </div>

  <!-- Remove Payee -->
  <div>
    <h3 class="text-lg font-semibold mb-2">Remove Payee</h3>
    <select id="removePayeeSelect" class="w-full p-2 border rounded mb-2">
      <!-- Dynamic options -->
    </select>
    <button id="removePayeeBtn" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">Remove Selected Payee</button>
  </div>
</div>

<script>
  const payeesTableBody = document.getElementById('payeesTableBody');
  const removePayeeSelect = document.getElementById('removePayeeSelect');

  // Load or initialize payees from localStorage
  function getPayees() {
    let stored = JSON.parse(localStorage.getItem('payees') || '[]');
    if(stored.length === 0){
      // Initialize with some default payees
      stored = [
        {name:'Raj Sharma', bank:'State Bank', branch:'Connaught Place', account:'SBIN00012345'},
        {name:'Anita Verma', bank:'HDFC Bank', branch:'Lajpat Nagar', account:'HDFC00067890'},
        {name:'Suresh Kumar', bank:'ICICI Bank', branch:'Saket', account:'ICIC00054321'}
      ];
      localStorage.setItem('payees', JSON.stringify(stored));
    }
    return stored;
  }

  function savePayees(payees) {
    localStorage.setItem('payees', JSON.stringify(payees));
  }

  // Render Payees Table & Remove Dropdown
  function renderPayees() {
    const payees = getPayees();
    payeesTableBody.innerHTML = '';
    removePayeeSelect.innerHTML = '<option value="">--Select Payee--</option>';

    payees.forEach((p, idx) => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td class="px-4 py-2 border">${p.name}</td>
        <td class="px-4 py-2 border">${p.bank}</td>
        <td class="px-4 py-2 border">${p.branch}</td>
        <td class="px-4 py-2 border">${p.account}</td>
        <td class="px-4 py-2 border text-center">
          <button onclick="removePayee(${idx})" class="bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600">Remove</button>
        </td>
      `;
      payeesTableBody.appendChild(row);
      removePayeeSelect.innerHTML += `<option value="${idx}">${p.name}</option>`;
    });
  }

  // Add new payee
  document.getElementById('addPayeeBtn').addEventListener('click', () => {
    const name = document.getElementById('addName').value.trim();
    const bank = document.getElementById('addBank').value.trim();
    const branch = document.getElementById('addBranch').value.trim();
    const account = document.getElementById('addAccount').value.trim();

    if(!name || !bank || !branch || !account) return alert('Please fill all fields!');

    const payees = getPayees();
    payees.push({name, bank, branch, account});
    savePayees(payees);

    document.getElementById('addName').value = '';
    document.getElementById('addBank').value = '';
    document.getElementById('addBranch').value = '';
    document.getElementById('addAccount').value = '';

    renderPayees();
  });

  // Remove selected payee from dropdown
  document.getElementById('removePayeeBtn').addEventListener('click', () => {
    const idx = removePayeeSelect.value;
    if(idx === '') return alert('Please select a payee to remove!');

    const payees = getPayees();
    payees.splice(idx,1);
    savePayees(payees);
    renderPayees();
  });

  // Remove payee via table button
  function removePayee(idx){
    const payees = getPayees();
    if(confirm(`Are you sure you want to remove ${payees[idx].name}?`)){
      payees.splice(idx,1);
      savePayees(payees);
      renderPayees();
    }
  }

  // Initial render
  renderPayees();
</script>

</body>
</html>
